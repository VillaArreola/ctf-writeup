---
const { posts, platform } = Astro.props;
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{platform} Writeups</title>
  </head>
  <body class="bg-black text-white font-sans px-6 py-10">
    <Header />

    <main class="max-w-6xl mx-auto">
      <h1 class="text-4xl font-bold mb-10 text-cyan-400">{platform} Writeups</h1>

      {posts.length > 0 ? (
        <div class="grid grid-cols-8 gap-6">
          {posts.map((post, i) => {
            const colSpan =
              i === 0 ? 'col-span-5' :
              i === 1 ? 'col-span-3' :
              i === 2 ? 'col-span-3' :
              i === 3 ? 'col-span-5' :
              'col-span-4';

            return (
              <a
                href={`/ctf/${post.slug}`}
                class={`group relative ${colSpan} bg-gradient-to-b from-[#16181d] to-[#0d0e10] rounded-2xl p-6 shadow-xl hover:scale-[1.01] transition duration-200 border border-gray-800 hover:border-cyan-400`}
              >
                <img
                src={`/images/ctf/${post.slug}-cover.webp`}
                alt={`Portada de ${post.data.title}`}
                onError={(e) => {
                  e.currentTarget.onerror = null;
                  e.currentTarget.src = '/images/default-cover.jpg';
                }}
                class="w-full h-40 object-cover rounded mb-4"
              />

                <div class="mb-4">
                  <h3 class="text-lg font-semibold text-white group-hover:text-cyan-400 transition">
                    {post.data.title}
                  </h3>
                  <p class="text-sm text-gray-400">
                    {post.data.platform} ‚Äî {new Date(post.data.publishedAt).toLocaleDateString()}
                  </p>
                </div>

                <div class="text-sm text-gray-500 leading-relaxed">
                  {post.data.preview || 'Este writeup a√∫n no tiene descripci√≥n. üöß'}
                </div>
              </a>
            );
          })}
        </div>
      ) : (
        <div class="text-center py-10">
          <p class="text-lg text-gray-400 mb-4">
            No hay writeups publicados a√∫n para esta plataforma.
          </p>
          <a
            href="/"
            class="inline-block px-5 py-2 bg-cyan-600 text-white rounded hover:bg-cyan-500 transition"
          >
            ‚Üê Volver al inicio
          </a>
        </div>
      )}
    </main>

    <Footer />
  </body>
</html>
