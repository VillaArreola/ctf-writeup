<aside
  x-data="{
    show: false,
    headings: [],
    active: '',
    observer: null,
    init() {
      const found = [...document.querySelectorAll('h2[id]')];
      this.headings = found.map(h => {
        h.setAttribute('data-section', '');
        return { id: h.id, text: h.textContent.trim() };
      });
      this.observer = new IntersectionObserver(entries => {
        for (const entry of entries) {
          if (entry.isIntersecting) {
            this.active = entry.target.id;
          }
        }
      }, { threshold: 0.3 });
      found.forEach(h => this.observer.observe(h));
    }
  }"
  class="relative"
  style="z-index: 999999 !important;"
>
  <!-- Bot√≥n para m√≥viles -->
  <button
    class="lg:hidden fixed top-32 left-4 z-[999999] bg-cyan-700 hover:bg-cyan-600 text-white px-3 py-2 rounded-lg shadow-lg transition-colors"
    @click="show = !show"
    style="z-index: 999999 !important;"
  >
    üß≠ √çndice
  </button>

  <!-- Overlay para m√≥viles -->
  <div
    x-show="show"
    x-transition.opacity
    x-cloak
    style="display: none; z-index: 999998 !important;"
    @click="show = false"
    class="fixed inset-0 bg-black/80 z-[999998] lg:hidden"
  ></div>

  <!-- Sidebar completo -->
  <div
    x-show="show || window.innerWidth >= 1024"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0 transform -translate-x-full"
    x-transition:enter-end="opacity-100 transform translate-x-0"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100 transform translate-x-0"
    x-transition:leave-end="opacity-0 transform -translate-x-full"
    x-cloak
    style="display: none; z-index: 999999 !important;"
    class="fixed lg:relative top-24 lg:top-0 left-0 h-full lg:h-auto w-64 lg:w-auto bg-gray-900 lg:bg-transparent border-r border-gray-700 lg:border-none z-[999999] lg:z-auto lg:mr-6 lg:block shadow-2xl lg:shadow-none"
  >
    <div class="p-4 lg:p-0 lg:sticky lg:top-20 lg:self-start lg:h-max">
      <div class="flex justify-between items-center mb-4 lg:hidden">
        <h3 class="text-white font-semibold">üìã √çndice</h3>
        <button
          @click="show = false"
          class="text-gray-400 hover:text-white"
        >
          ‚úï
        </button>
      </div>
      
      <ul class="space-y-2 text-sm text-gray-400">
        <template x-for="item in headings" :key="item.id">
          <li>
            <a
              :href="`#${item.id}`"
              @click="show = false"
              :class="{
                'text-cyan-400 font-semibold': active === item.id,
                'text-gray-400 hover:text-cyan-400': active !== item.id
              }"
              class="block py-1 px-2 rounded hover:bg-gray-800/50 transition-colors"
              x-text="item.text"
            ></a>
          </li>
        </template>
      </ul>
    </div>
  </div>
</aside>
