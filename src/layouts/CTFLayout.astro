---
import SidebarCTF from '../components/SidebarCTF.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import '../styles/global.css';

const { frontmatter } = Astro.props;
---

<html lang="es" class="min-h-screen">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- TÃ­tulo dinÃ¡mico -->
    <title>{frontmatter.title} - Writeups CTF</title>
    
    <!-- Metadatos bÃ¡sicos -->
    <meta name="description" content={frontmatter.preview || `Write-up tÃ©cnico de ${frontmatter.title} en ${frontmatter.platform}`} />
    <meta name="author" content="Villa Arreola" />
    <meta name="robots" content="index, follow" />
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article" />
    <meta property="og:url" content={`https://ctf.villaarreola.com/ctf/${frontmatter.slug}`} />
    <meta property="og:title" content={frontmatter.title} />
    <meta property="og:description" content={frontmatter.preview || `Write-up tÃ©cnico de ${frontmatter.title} en ${frontmatter.platform}`} />
    <meta property="og:image" content={frontmatter.cover ? `https://ctf.villaarreola.com${frontmatter.cover}` : 'https://ctf.villaarreola.com/images/default-cover.svg'} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Writeups CTF" />
    <meta property="og:locale" content="es_MX" />
    <meta property="article:published_time" content={frontmatter.publishedAt} />
    <meta property="article:author" content="Villa Arreola" />
    {frontmatter.tags?.map(tag => (
      <meta property="article:tag" content={tag} />
    ))}
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={`https://ctf.villaarreola.com/ctf/${frontmatter.slug}`} />
    <meta property="twitter:title" content={frontmatter.title} />
    <meta property="twitter:description" content={frontmatter.preview || `Write-up tÃ©cnico de ${frontmatter.title} en ${frontmatter.platform}`} />
    <meta property="twitter:image" content={frontmatter.cover ? `https://ctf.villaarreola.com${frontmatter.cover}` : 'https://ctf.villaarreola.com/images/default-cover.svg'} />
    <meta property="twitter:creator" content="@villaarreola" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/images/MVLOGO.png" />
    <link rel="apple-touch-icon" href="/images/MVLOGO.png" />
    
    <!-- Tema de color -->
    <meta name="theme-color" content="#0891b2" />
    <meta name="msapplication-TileColor" content="#0891b2" />
    
    <!-- Comentarios -->
    <script defer src="https://cusdis.com/js/cusdis.es.js"></script>
  </head>

  <body class="min-h-screen flex flex-col bg-black text-white font-sans">
    <Header frontmatter={frontmatter} />
    




    <div class="flex flex-grow max-w-7xl mx-auto py-10 px-6 w-full">
      <!-- Sidebar con Ã­ndice dinÃ¡mico -->
      <SidebarCTF frontmatter={frontmatter} />

      <!-- Contenido principal -->
      <main class="w-4/5">
        <!-- Banner del writeup -->
        <section
        class="relative w-full min-h-64 text-white overflow-hidden rounded-xl shadow mb-8 flex flex-col justify-end"
        style={`background-image: url('/images/ctf/${frontmatter.slug}-cover.webp'); background-size: cover; background-position: center;`}
      >
        <!-- Contenido responsivo abajo -->
        <div class="z-10 px-4 py-3 sm:px-6 sm:py-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-6 bg-gradient-to-t from-black/80 sm:bg-black/70 backdrop-blur-sm">
          <!-- Info -->
          <div class="flex flex-col gap-2">
            <h1 class="text-xl sm:text-2xl font-bold text-cyan-400">{frontmatter.title}</h1>
            <div class="flex gap-3 flex-wrap text-xs sm:text-sm text-gray-300">
              <span>ðŸ§© CVE: <strong>{frontmatter.cve ?? 'N/A'}</strong></span>
              <span>ðŸ’ª Dificultad: <strong>{frontmatter.difficulty ?? 'Desconocida'}</strong></span>
              <span>ðŸ“… Fecha: <strong>{new Date(frontmatter.publishedAt).toLocaleDateString('es-MX')}</strong></span>
            </div>
          </div>
      
          <!-- Tags -->
          <div class="flex gap-2 flex-wrap justify-start sm:justify-end">
            {frontmatter.tags?.map(tag => {
              const tagColors = {
                THM: 'bg-purple-600',
                HTB: 'bg-red-600',
                CiberLabs: 'bg-orange-600',
                OSINT: 'bg-yellow-500',
                Default: 'bg-cyan-800',
              };
              const color = tagColors[tag] || tagColors.Default;
      
              return (
                <span
                  class={`text-white px-2 py-0.5 rounded-full text-xs whitespace-nowrap hover:brightness-110 transition duration-200 ${color}`}
                >
                  ðŸ”– {tag}
                </span>
              );
            })}
          </div>
        </div>
      </section>
      
      

      
      
        <article class="prose prose-invert max-w-none">
          <slot />
        </article>
      
        <!-- Comentarios (mantener fuera del artÃ­culo) -->
        <div class="mt-16">
          <div
            id="cusdis_thread"
            data-host="https://cusdis.com"
            data-app-id="TU_ID_CUSDIS"
            data-page-id={frontmatter.slug}
            data-page-url={`https://ctf.villaarreola.com/ctf/${frontmatter.slug}`}
            data-page-title={frontmatter.title}
          ></div>
        </div>
      </main>
    </div>

    <Footer />
  </body>
</html>
